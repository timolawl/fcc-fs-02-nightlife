{"version":3,"sources":["../../../node_modules/browser-pack/_prelude.js","post.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","conductSearch","searchValue","socket","emit","location","sessionStorage","setItem","console","log","getItem","document","querySelector","classList","remove","toggleView","inputLength","logoutAction","logStatus","contains","toggle","io","window","onload","searchInput","textContent","addEventListener","removeItem","href","referrer","value","Array","prototype","forEach","querySelectorAll","el","add","target","key","which","keyCode"],"mappings":"CAAA,QAAAA,GAAAC,EAAAC,EAAAC,GAAA,QAAAC,GAAAC,EAAAC,GAAA,IAAAJ,EAAAG,GAAA,CAAA,IAAAJ,EAAAI,GAAA,CAAA,GAAAE,GAAA,kBAAAC,UAAAA,OAAA,KAAAF,GAAAC,EAAA,MAAAA,GAAAF,GAAA,EAAA,IAAAI,EAAA,MAAAA,GAAAJ,GAAA,EAAA,IAAAK,GAAA,GAAAC,OAAA,uBAAAN,EAAA,IAAA,MAAAK,GAAAE,KAAA,mBAAAF,EAAA,GAAAG,GAAAX,EAAAG,IAAAS,WAAAb,GAAAI,GAAA,GAAAU,KAAAF,EAAAC,QAAA,SAAAd,GAAA,GAAAE,GAAAD,EAAAI,GAAA,GAAAL,EAAA,OAAAI,GAAAF,EAAAA,EAAAF,IAAAa,EAAAA,EAAAC,QAAAd,EAAAC,EAAAC,EAAAC,GAAA,MAAAD,GAAAG,GAAAS,QAAA,IAAA,GAAAL,GAAA,kBAAAD,UAAAA,QAAAH,EAAA,EAAAA,EAAAF,EAAAa,OAAAX,IAAAD,EAAAD,EAAAE,GAAA,OAAAD,KAAAa,GAAA,SAAAT,QAAAU,OAAAJ,SCAA,YA0GA,SAASK,eAAeC,aACtBC,OAAOC,KAAK,cAAgBC,SAAUH,cAEtCI,eAAeC,QAAQ,iBAAkBL,aACzCM,QAAQC,IAAI,wBAA0BH,eAAeI,QAAQ,mBAE7DC,SAASC,cAAc,UAAUC,UAAUC,OAAO,sBAClDH,SAASC,cAAc,aAAaC,UAAUC,OAAO,oBAIvD,QAASC,YAAYC,YAAaC,aAAcC,YAGzCF,cAAgBL,SAASC,cAAc,YAAYC,UAAUM,SAAS,iBAAoBF,gBAC7FN,SAASC,cAAc,YAAYC,UAAUO,OAAO,gBACpDT,SAASC,cAAc,oBAAoBC,UAAUO,OAAO,wBAC5DT,SAASC,cAAc,uBAAuBC,UAAUO,OAAO,iBAC/DT,SAASC,cAAc,4BAA4BC,UAAUO,OAAO,iBACpET,SAASC,cAAc,0BAA0BC,UAAUO,OAAO,iBAClET,SAASC,cAAc,qBAAqBC,UAAUO,OAAO,iBAC7DT,SAASC,cAAc,0BAA0BC,UAAUO,OAAO,iBAEhD,YAAdF,WACFP,SAASC,cAAc,gCAAgCC,UAAUO,OAAO,kBA/H9E,GAAIjB,QAASkB,IAEbC,QAAOC,OAAS,WAGd,GAOIC,aAPAN,UAAYP,SAASC,cAAc,wBAAwBa,WAEjDd,UAASC,cAAc,kBAAkBc,iBAAiB,QAAS,SAAA5C,GAC/EwB,eAAeqB,WAAW,kBAC1BtB,SAASuB,KAAO,KAOhBJ,aADElB,eAAeI,QAAQ,kBACXJ,eAAeI,QAAQ,kBAEpB,GAKnBF,QAAQC,IAAI,sBAAwBE,SAASkB,UAC7CrB,QAAQC,IAAI,iBAAmBe,aAE3BA,cACFb,SAASC,cAAc,2BAA2BkB,MAAQN,YAE1DT,WAAWS,YAAY1B,QAAQ,EAAOoB,WAEtCjB,cAAcuB,cAKhBO,MAAMC,UAAUC,QAAQpC,KAAKc,SAASuB,iBAAiB,wBAAyB,SAAAC,IAAA,MAAMA,IAAGT,iBAAiB,QAAS,WAC/F,WAAdR,WACFP,SAASC,cAAc,YAAYC,UAAUC,OAAO,oBACpDH,SAASC,cAAc,UAAUC,UAAUC,OAAO,kBAE7B,YAAdI,YACPZ,eAAeqB,WAAW,kBAE1BhB,SAASC,cAAc,2BAA2BkB,MAAQ,GAI1DnB,SAASC,cAAc,aAAaC,UAAUuB,IAAI,oBAClDzB,SAASC,cAAc,UAAUC,UAAUuB,IAAI,sBAC3CzB,SAASC,cAAc,YAAYC,UAAUM,SAAS,iBACxDJ,WAAW,GAAG,EAAMG,WAEtBb,SAASuB,KAAO,eAKpBjB,SAASC,cAAc,oBAAoBc,iBAAiB,QAAS,SAAA5C,GACnE0C,YAAcb,SAASC,cAAc,2BAA2BkB,MAE5DhD,EAAEuD,OAAOxB,UAAUM,SAAS,4BAA8BK,aAG5DvB,cAAcuB,eAIlBb,SAASC,cAAc,oBAAoBc,iBAAiB,QAAS,SAAA5C,GAEnE0C,YAAcb,SAASC,cAAc,2BAA2BkB,KAChE,IAAIQ,KAAMxD,EAAEyD,OAASzD,EAAE0D,OACX,MAARF,KAAcd,aAChBvB,cAAcuB,eAMlBb,SAASC,cAAc,2BAA2Bc,iBAAiB,QAAS,SAAA5C,GAK1E0B,QAAQC,IAAI3B,EAAEuD,OAAOP,OACrBtB,QAAQC,IAAI3B,EAAEuD,OAAOvC,QACrBiB,WAAWjC,EAAEuD,OAAOP,MAAMhC,QAAQ,EAAOoB,aAI3CP,SAASC,cAAc,wBAAwBc,iBAAiB,QAAS,WACvEf,SAASC,cAAc,YAAYC,UAAUuB,IAAI,oBACjDzB,SAASC,cAAc,UAAUC,UAAUuB,IAAI,mBAGjDzB,SAASC,cAAc,YAAYc,iBAAiB,QAAS,WAC3Df,SAASC,cAAc,YAAYC,UAAUuB,IAAI,oBACjDzB,SAASC,cAAc,UAAUC,UAAUuB,IAAI","file":"post.bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\n// socket io -- the cdnjs script is in the HTML template above this script file\nvar socket = io();\n\nwindow.onload = function () {\n\n\n  var logStatus = document.querySelector('.mainbox__log-button').textContent;\n\n  var logoBtn = document.querySelector('.bn-logo--link').addEventListener('click', e => {\n    sessionStorage.removeItem('searchLocation');\n    location.href = '/';\n  });\n\n  var searchInput;\n\n  // if a search of a previous session has been completed..\n  if (sessionStorage.getItem('searchLocation')) {\n    searchInput = sessionStorage.getItem('searchLocation');\n  }\n  else searchInput = '';\n\n  // if document referrer was the login completion,\n  // and logstatus is logged in\n  // populate the input field with the previous input and do a search.\n  console.log('document.referrer: ' + document.referrer);\n  console.log('search input: ' + searchInput);\n  \n  if (searchInput) {\n    document.querySelector('.mainbox__search--input').value = searchInput;\n    // move items to top\n    toggleView(searchInput.length, false, logStatus);\n        // generate results\n    conductSearch(searchInput);\n  }\n\n\n  // show modal on clicking the log in button\n  Array.prototype.forEach.call(document.querySelectorAll('.mainbox__log-button'), el => el.addEventListener('click', () => {\n    if (logStatus === 'Log In') {\n      document.querySelector('.overlay').classList.remove('visibility--hide');\n      document.querySelector('.modal').classList.remove('display--hide');\n    }\n    else if (logStatus === 'Log Out') {\n      sessionStorage.removeItem('searchLocation');\n      // adding this because the redirect to find out that there should be nothing here is a bit slow...\n      document.querySelector('.mainbox__search--input').value = '';\n\n      \n      //basically conductSearch in reverse\n      document.querySelector('.bar-list').classList.add('visibility--hide');\n      document.querySelector('footer').classList.add('footer--unsearched');\n      if (document.querySelector('.mainbox').classList.contains('mainbox--top')) {\n        toggleView(0, true, logStatus); // passing a length of 0\n      }\n      location.href = '/logout'; \n    }\n  }));\n\n  // on submit, reveal results and unfix the display of footer\n  document.querySelector('.mainbox__search').addEventListener('click', e => {\n    searchInput = document.querySelector('.mainbox__search--input').value;\n    // on submit button press and with content in input box:\n    if (e.target.classList.contains('mainbox__search--submit') && searchInput) { // submit button pressed with inputted content\n      // emit socket\n      // server side environmental variables are needed so the ajax call is better off not performed here\n      conductSearch(searchInput);\n    }\n  });\n\n  document.querySelector('.mainbox__search').addEventListener('keyup', e => {\n    // on mainbox focus and enter key press with content in input box:\n    searchInput = document.querySelector('.mainbox__search--input').value;\n    var key = e.which || e.keyCode;\n    if (key === 13 && searchInput) { // on enter key press\n      conductSearch(searchInput);\n    }\n  });\n\n\n  // when there is input, change view to have search bar at the top of the page\n  document.querySelector('.mainbox__search--input').addEventListener('input', e => {\n    // if there is content and the previous state was empty, toggle\n    //if ((e.target.value || e.target.length !== 0) && previousState.length === 0) {\n    \n    //}\n    console.log(e.target.value);\n    console.log(e.target.length);\n    toggleView(e.target.value.length, false, logStatus);\n  });\n\n  // When the modal close button or the overlay is clicked, exit the modal condition\n  document.querySelector('.social-login__close').addEventListener('click', () => {\n    document.querySelector('.overlay').classList.add('visibility--hide');\n    document.querySelector('.modal').classList.add('display--hide');\n  });\n  \n  document.querySelector('.overlay').addEventListener('click', () => {\n    document.querySelector('.overlay').classList.add('visibility--hide');\n    document.querySelector('.modal').classList.add('display--hide');\n  });\n\n};\n\n\nfunction conductSearch (searchValue) {\n  socket.emit('bar search', { location: searchValue });\n  // store the most recent search location in sessionStorage\n  sessionStorage.setItem('searchLocation', searchValue);\n  console.log('session storage set: ' + sessionStorage.getItem('searchLocation'));\n\n  document.querySelector('footer').classList.remove('footer--unsearched');\n  document.querySelector('.bar-list').classList.remove('visibility--hide');\n\n}\n\nfunction toggleView (inputLength, logoutAction, logStatus) {\n  // if there is content and the top display is not already displayed, then toggle\n  // or if there is no content and regular display is not already displayed, then toggle\n  if ((inputLength && !document.querySelector('.mainbox').classList.contains('mainbox--top')) || logoutAction) {\n    document.querySelector('.mainbox').classList.toggle('mainbox--top'); // move mainbox to top\n    document.querySelector('.mainbox__search').classList.toggle('mainbox__search--top'); // left-aign search input\n    document.querySelector('.mainbox__title-row').classList.toggle('display--hide');\n    document.querySelector('.mainbox__title-row--top').classList.toggle('display--hide');\n    document.querySelector('.mainbox__subtitle-row').classList.toggle('display--hide');\n    document.querySelector('.mainbox__log-row').classList.toggle('display--hide');\n    document.querySelector('.mainbox__log-row--top').classList.toggle('display--hide');\n    \n    if (logStatus === 'Log Out') {\n      document.querySelector('.mainbox__login-details--top').classList.toggle('display--hide');\n    }\n    \n  }\n}\n"]}