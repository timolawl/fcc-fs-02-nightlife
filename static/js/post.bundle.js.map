{"version":3,"sources":["../../../node_modules/browser-pack/_prelude.js","post.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","conductSearch","searchValue","socket","emit","location","sessionStorage","setItem","console","log","getItem","document","querySelector","classList","remove","toggleView","inputLength","logoutAction","logStatus","contains","toggle","createListing","business","row","widthContainer","createElement","className","appendChild","card","cardSection","img","src","image_url","barTitle","barLink","href","url","textContent","name","barReview","excerpt","goingButton","setAttribute","goingCount","goingText","io","window","onload","searchInput","addEventListener","removeItem","referrer","value","Array","prototype","forEach","querySelectorAll","el","add","target","key","which","keyCode","on","data","yelpReviews","reviews","listings","createDocumentFragment","listingNumber","currentRow","newRow"],"mappings":"CAAA,QAAAA,GAAAC,EAAAC,EAAAC,GAAA,QAAAC,GAAAC,EAAAC,GAAA,IAAAJ,EAAAG,GAAA,CAAA,IAAAJ,EAAAI,GAAA,CAAA,GAAAE,GAAA,kBAAAC,UAAAA,OAAA,KAAAF,GAAAC,EAAA,MAAAA,GAAAF,GAAA,EAAA,IAAAI,EAAA,MAAAA,GAAAJ,GAAA,EAAA,IAAAK,GAAA,GAAAC,OAAA,uBAAAN,EAAA,IAAA,MAAAK,GAAAE,KAAA,mBAAAF,EAAA,GAAAG,GAAAX,EAAAG,IAAAS,WAAAb,GAAAI,GAAA,GAAAU,KAAAF,EAAAC,QAAA,SAAAd,GAAA,GAAAE,GAAAD,EAAAI,GAAA,GAAAL,EAAA,OAAAI,GAAAF,EAAAA,EAAAF,IAAAa,EAAAA,EAAAC,QAAAd,EAAAC,EAAAC,EAAAC,GAAA,MAAAD,GAAAG,GAAAS,QAAA,IAAA,GAAAL,GAAA,kBAAAD,UAAAA,QAAAH,EAAA,EAAAA,EAAAF,EAAAa,OAAAX,IAAAD,EAAAD,EAAAE,GAAA,OAAAD,KAAAa,GAAA,SAAAT,QAAAU,OAAAJ,SCAA,YA0GA,SAASK,eAAeC,aACtBC,OAAOC,KAAK,cAAgBC,SAAUH,cAEtCI,eAAeC,QAAQ,iBAAkBL,aACzCM,QAAQC,IAAI,wBAA0BH,eAAeI,QAAQ,mBAE7DC,SAASC,cAAc,UAAUC,UAAUC,OAAO,sBAClDH,SAASC,cAAc,aAAaC,UAAUC,OAAO,oBAIvD,QAASC,YAAYC,YAAaC,aAAcC,YAGzCF,cAAgBL,SAASC,cAAc,YAAYC,UAAUM,SAAS,iBAAoBF,gBAC7FN,SAASC,cAAc,YAAYC,UAAUO,OAAO,gBACpDT,SAASC,cAAc,oBAAoBC,UAAUO,OAAO,wBAC5DT,SAASC,cAAc,uBAAuBC,UAAUO,OAAO,iBAC/DT,SAASC,cAAc,4BAA4BC,UAAUO,OAAO,iBACpET,SAASC,cAAc,0BAA0BC,UAAUO,OAAO,iBAClET,SAASC,cAAc,qBAAqBC,UAAUO,OAAO,iBAC7DT,SAASC,cAAc,0BAA0BC,UAAUO,OAAO,iBAEhD,YAAdF,WACFP,SAASC,cAAc,gCAAgCC,UAAUO,OAAO,kBAgC9E,QAASC,eAAeC,SAAUC,KAChCf,QAAQC,IAAI,oBACZ,IAAIe,gBAAiBb,SAASc,cAAc,MAC5CD,gBAAeE,UAAY,0BAC3BH,IAAII,YAAYH,eAChB,IAAII,MAAOjB,SAASc,cAAc,MAClCG,MAAKF,UAAY,OACjBF,eAAeG,YAAYC,KAC3B,IAAIC,aAAclB,SAASc,cAAc,MACzCI,aAAYH,UAAY,2BACxBE,KAAKD,YAAYE,YACjB,IAAIC,KAAMnB,SAASc,cAAc,MACjCK,KAAIJ,UAAY,0CAChBI,IAAIC,IAAMT,SAASU,UACnBH,YAAYF,YAAYG,IACxB,IAAIG,UAAWtB,SAASc,cAAc,MAClCS,QAAUvB,SAASc,cAAc,IACrCS,SAAQR,UAAY,aACpBQ,QAAQC,KAAOb,SAASc,IACxBF,QAAQG,YAAcf,SAASgB,KAC/BL,SAASN,YAAYO,SACrBL,YAAYF,YAAYM,SACxB,IAAIM,WAAY5B,SAASc,cAAc,IACvCc,WAAUb,UAAY,yBACtBa,UAAUF,YAAcf,SAASkB,QACjCX,YAAYF,YAAYY,UACxB,IAAIE,aAAc9B,SAASc,cAAc,SACzCgB,aAAYf,UAAY,mBACxBe,YAAYC,aAAa,OAAQ,UACjCb,YAAYF,YAAYc,YACxB,IAAIE,YAAahC,SAASc,cAAc,OACxCkB,YAAWjB,UAAY,kBACvBiB,WAAWN,YAAc,IACzBI,YAAYd,YAAYgB,WACxB,IAAIC,WAAYjC,SAASc,cAAc,OACvCmB,WAAUlB,UAAY,mBACtBkB,UAAUP,YAAc,QACtBI,YAAYd,YAAYiB,WApM5B,GAAIzC,QAAS0C,IAEbC,QAAOC,OAAS,WAGd,GAOIC,aAPA9B,UAAYP,SAASC,cAAc,wBAAwByB,WAEjD1B,UAASC,cAAc,kBAAkBqC,iBAAiB,QAAS,SAAAnE,GAC/EwB,eAAe4C,WAAW,kBAC1B7C,SAAS8B,KAAO,KAOhBa,aADE1C,eAAeI,QAAQ,kBACXJ,eAAeI,QAAQ,kBAEpB,GAKnBF,QAAQC,IAAI,sBAAwBE,SAASwC,UAC7C3C,QAAQC,IAAI,iBAAmBuC,aAE3BA,cACFrC,SAASC,cAAc,2BAA2BwC,MAAQJ,YAE1DjC,WAAWiC,YAAYlD,QAAQ,EAAOoB,WAEtCjB,cAAc+C,cAKhBK,MAAMC,UAAUC,QAAQ1D,KAAKc,SAAS6C,iBAAiB,wBAAyB,SAAAC,IAAA,MAAMA,IAAGR,iBAAiB,QAAS,WAC/F,WAAd/B,WACFP,SAASC,cAAc,YAAYC,UAAUC,OAAO,oBACpDH,SAASC,cAAc,UAAUC,UAAUC,OAAO,kBAE7B,YAAdI,YACPZ,eAAe4C,WAAW,kBAE1BvC,SAASC,cAAc,2BAA2BwC,MAAQ,GAI1DzC,SAASC,cAAc,aAAaC,UAAU6C,IAAI,oBAClD/C,SAASC,cAAc,UAAUC,UAAU6C,IAAI,sBAC3C/C,SAASC,cAAc,YAAYC,UAAUM,SAAS,iBACxDJ,WAAW,GAAG,EAAMG,WAEtBb,SAAS8B,KAAO,eAKpBxB,SAASC,cAAc,oBAAoBqC,iBAAiB,QAAS,SAAAnE,GACnEkE,YAAcrC,SAASC,cAAc,2BAA2BwC,MAE5DtE,EAAE6E,OAAO9C,UAAUM,SAAS,4BAA8B6B,aAG5D/C,cAAc+C,eAIlBrC,SAASC,cAAc,oBAAoBqC,iBAAiB,QAAS,SAAAnE,GAEnEkE,YAAcrC,SAASC,cAAc,2BAA2BwC,KAChE,IAAIQ,KAAM9E,EAAE+E,OAAS/E,EAAEgF,OACX,MAARF,KAAcZ,aAChB/C,cAAc+C,eAMlBrC,SAASC,cAAc,2BAA2BqC,iBAAiB,QAAS,SAAAnE,GAK1E0B,QAAQC,IAAI3B,EAAE6E,OAAOP,OACrB5C,QAAQC,IAAI3B,EAAE6E,OAAO7D,QACrBiB,WAAWjC,EAAE6E,OAAOP,MAAMtD,QAAQ,EAAOoB,aAI3CP,SAASC,cAAc,wBAAwBqC,iBAAiB,QAAS,WACvEtC,SAASC,cAAc,YAAYC,UAAU6C,IAAI,oBACjD/C,SAASC,cAAc,UAAUC,UAAU6C,IAAI,mBAGjD/C,SAASC,cAAc,YAAYqC,iBAAiB,QAAS,WAC3DtC,SAASC,cAAc,YAAYC,UAAU6C,IAAI,oBACjD/C,SAASC,cAAc,UAAUC,UAAU6C,IAAI,oBAoCnDvD,OAAO4D,GAAG,cAAe,SAAUC,MACjCxD,QAAQC,IAAI,8BACZ,IAAMwD,aAAcD,KAAKE,QACrBC,SAAWxD,SAASyD,wBACxBD,UAASzC,UAAY,mBACrBlB,QAAQC,IAAI,oBAAsBwD,YAAYnE,OAC9C,KAAK,GAAIuE,eAAgB,EAAGA,cAAgBJ,YAAYnE,OAAQuE,gBAAiB,CAC/E7D,QAAQC,IAAI,gBACZ,IAAI6D,YAAA,MACJ,IAAsB,IAAlBD,eAAuBA,cAAgB,IAAM,EAAG,CAElD,GAAIE,QAAS5D,SAASc,cAAc,MACpC8C,QAAO7C,UAAY,MACnByC,SAASxC,YAAY4C,QACrBD,WAAaC,WAGbD,YAAaH,SAASvD,cAAc,oBAGtCS,eAAc4C,YAAYI,eAAgBC,YAG5C3D,SAASC,cAAc,aAAae,YAAYwC","file":"post.bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\n// socket io -- the cdnjs script is in the HTML template above this script file\nvar socket = io();\n\nwindow.onload = function () {\n\n\n  var logStatus = document.querySelector('.mainbox__log-button').textContent;\n\n  var logoBtn = document.querySelector('.bn-logo--link').addEventListener('click', e => {\n    sessionStorage.removeItem('searchLocation');\n    location.href = '/';\n  });\n\n  var searchInput;\n\n  // if a search of a previous session has been completed..\n  if (sessionStorage.getItem('searchLocation')) {\n    searchInput = sessionStorage.getItem('searchLocation');\n  }\n  else searchInput = '';\n\n  // if document referrer was the login completion,\n  // and logstatus is logged in\n  // populate the input field with the previous input and do a search.\n  console.log('document.referrer: ' + document.referrer);\n  console.log('search input: ' + searchInput);\n  \n  if (searchInput) {\n    document.querySelector('.mainbox__search--input').value = searchInput;\n    // move items to top\n    toggleView(searchInput.length, false, logStatus);\n        // generate results\n    conductSearch(searchInput);\n  }\n\n\n  // show modal on clicking the log in button\n  Array.prototype.forEach.call(document.querySelectorAll('.mainbox__log-button'), el => el.addEventListener('click', () => {\n    if (logStatus === 'Log In') {\n      document.querySelector('.overlay').classList.remove('visibility--hide');\n      document.querySelector('.modal').classList.remove('display--hide');\n    }\n    else if (logStatus === 'Log Out') {\n      sessionStorage.removeItem('searchLocation');\n      // adding this because the redirect to find out that there should be nothing here is a bit slow...\n      document.querySelector('.mainbox__search--input').value = '';\n\n      \n      //basically conductSearch in reverse\n      document.querySelector('.bar-list').classList.add('visibility--hide');\n      document.querySelector('footer').classList.add('footer--unsearched');\n      if (document.querySelector('.mainbox').classList.contains('mainbox--top')) {\n        toggleView(0, true, logStatus); // passing a length of 0\n      }\n      location.href = '/logout'; \n    }\n  }));\n\n  // on submit, reveal results and unfix the display of footer\n  document.querySelector('.mainbox__search').addEventListener('click', e => {\n    searchInput = document.querySelector('.mainbox__search--input').value;\n    // on submit button press and with content in input box:\n    if (e.target.classList.contains('mainbox__search--submit') && searchInput) { // submit button pressed with inputted content\n      // emit socket\n      // server side environmental variables are needed so the ajax call is better off not performed here\n      conductSearch(searchInput);\n    }\n  });\n\n  document.querySelector('.mainbox__search').addEventListener('keyup', e => {\n    // on mainbox focus and enter key press with content in input box:\n    searchInput = document.querySelector('.mainbox__search--input').value;\n    var key = e.which || e.keyCode;\n    if (key === 13 && searchInput) { // on enter key press\n      conductSearch(searchInput);\n    }\n  });\n\n\n  // when there is input, change view to have search bar at the top of the page\n  document.querySelector('.mainbox__search--input').addEventListener('input', e => {\n    // if there is content and the previous state was empty, toggle\n    //if ((e.target.value || e.target.length !== 0) && previousState.length === 0) {\n    \n    //}\n    console.log(e.target.value);\n    console.log(e.target.length);\n    toggleView(e.target.value.length, false, logStatus);\n  });\n\n  // When the modal close button or the overlay is clicked, exit the modal condition\n  document.querySelector('.social-login__close').addEventListener('click', () => {\n    document.querySelector('.overlay').classList.add('visibility--hide');\n    document.querySelector('.modal').classList.add('display--hide');\n  });\n  \n  document.querySelector('.overlay').addEventListener('click', () => {\n    document.querySelector('.overlay').classList.add('visibility--hide');\n    document.querySelector('.modal').classList.add('display--hide');\n  });\n\n};\n\n\nfunction conductSearch (searchValue) {\n  socket.emit('bar search', { location: searchValue });\n  // store the most recent search location in sessionStorage\n  sessionStorage.setItem('searchLocation', searchValue);\n  console.log('session storage set: ' + sessionStorage.getItem('searchLocation'));\n\n  document.querySelector('footer').classList.remove('footer--unsearched');\n  document.querySelector('.bar-list').classList.remove('visibility--hide');\n\n}\n\nfunction toggleView (inputLength, logoutAction, logStatus) {\n  // if there is content and the top display is not already displayed, then toggle\n  // or if there is no content and regular display is not already displayed, then toggle\n  if ((inputLength && !document.querySelector('.mainbox').classList.contains('mainbox--top')) || logoutAction) {\n    document.querySelector('.mainbox').classList.toggle('mainbox--top'); // move mainbox to top\n    document.querySelector('.mainbox__search').classList.toggle('mainbox__search--top'); // left-aign search input\n    document.querySelector('.mainbox__title-row').classList.toggle('display--hide');\n    document.querySelector('.mainbox__title-row--top').classList.toggle('display--hide');\n    document.querySelector('.mainbox__subtitle-row').classList.toggle('display--hide');\n    document.querySelector('.mainbox__log-row').classList.toggle('display--hide');\n    document.querySelector('.mainbox__log-row--top').classList.toggle('display--hide');\n    \n    if (logStatus === 'Log Out') {\n      document.querySelector('.mainbox__login-details--top').classList.toggle('display--hide');\n    }\n    \n  }\n}\n\nsocket.on('bar results', function (data) {\n  console.log('socket emission received...');\n  const yelpReviews = data.reviews;\n  let listings = document.createDocumentFragment();\n  listings.className = 'visibility--hide';\n  console.log('business length: ' + yelpReviews.length);\n  for (let listingNumber = 0; listingNumber < yelpReviews.length; listingNumber++) {\n    console.log('o hi there...');\n    let currentRow;\n    if (listingNumber === 0 || listingNumber % 3 === 0) {\n      //create new row\n      let newRow = document.createElement('div')\n      newRow.className = 'row';\n      listings.appendChild(newRow);\n      currentRow = newRow;\n    }\n    else {\n      currentRow = listings.querySelector('.row:last-of-type')\n    }\n\n    createListing(yelpReviews[listingNumber], currentRow);\n  }\n\n  document.querySelector('.bar-list').appendChild(listings);\n});\n\nfunction createListing (business, row) {\n  console.log('making listings..');\n  let widthContainer = document.createElement('div');\n  widthContainer.className = 'column medium-4 large-4';\n  row.appendChild(widthContainer);\n  let card = document.createElement('div');\n  card.className = 'card';\n  widthContainer.appendChild(card);\n  let cardSection = document.createElement('div');\n  cardSection.className = 'card-section text-center';\n  card.appendChild(cardSection);\n  let img = document.createElement('img');\n  img.className = 'img-fluid img-thumbnail mx-auto d-block';\n  img.src = business.image_url;\n  cardSection.appendChild(img);\n  let barTitle = document.createElement('h6');\n  let barLink = document.createElement('a');\n  barLink.className = 'bar__title';\n  barLink.href = business.url;\n  barLink.textContent = business.name;\n  barTitle.appendChild(barLink);\n  cardSection.appendChild(barTitle);\n  let barReview = document.createElement('p');\n  barReview.className = 'card-text text-justify';\n  barReview.textContent = business.excerpt;\n  cardSection.appendChild(barReview);\n  let goingButton = document.createElement('button');\n  goingButton.className = 'button secondary';\n  goingButton.setAttribute('type', 'button');\n  cardSection.appendChild(goingButton);\n  let goingCount = document.createElement('span');\n  goingCount.className = 'badge secondary';\n  goingCount.textContent = '0';\n  goingButton.appendChild(goingCount);\n  let goingText = document.createElement('span');\n  goingText.className = 'bar__going--text';\n  goingText.textContent = 'Going';\n    goingButton.appendChild(goingText);\n}\n"]}